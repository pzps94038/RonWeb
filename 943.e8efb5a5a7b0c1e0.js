"use strict";(self.webpackChunkRonWeb=self.webpackChunkRonWeb||[]).push([[943],{5853:(x,l,r)=>{r.r(l),r.d(l,{ArticleCreateComponent:()=>P});var t=r(3020),_=r(4755),E=r(6355),f=r(5177),a=r(5030),g=r(3500),c=r(9096),h=r(6274),v=r(166),u=r(9300),d=r(4004),m=r(8746),C=r(3900),p=r(6736),A=r(8884),I=r(9148),M=r(2436);function O(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",2),t.NdJ("ngSubmit",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.submit())}),t.TgZ(2,"div",3),t._UZ(3,"app-input",4),t.qZA(),t.TgZ(4,"div",3),t._UZ(5,"app-select",5),t.qZA(),t.TgZ(6,"div",3),t._UZ(7,"app-editor",6),t.qZA(),t.TgZ(8,"div",3),t._UZ(9,"app-editor",7),t.qZA(),t.TgZ(10,"div",8)(11,"button",9),t._uU(12," \u65b0\u589e\u6587\u7ae0 "),t.qZA()()(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(4),t.Q6J("options",e.categoryOptions()),t.xp6(6),t.ekj("loading",e.createIsLoading()),t.Q6J("disabled",e.createIsLoading())}}function D(n,i){1&n&&t._UZ(0,"app-load-article")}let P=(()=>{class n{constructor(){this.sharedSrv=(0,t.f3M)(g.F),this.swalSrv=(0,t.f3M)(c.J),this.articleCategorySrv=(0,t.f3M)(h.h),this.articleSrv=(0,t.f3M)(A.n),this.router=(0,t.f3M)(I.F0),this.isLoading=(0,t.tdS)(!1),this.createIsLoading=(0,t.tdS)(!1),this.categoryOptions=(0,t.tdS)([]),this.prevFiles=(0,t.tdS)([]),this.contentFiles=(0,t.tdS)([]),this.form=new a.cw({articleTitle:new a.NI("",[a.kI.required]),previewContent:new a.NI("",[a.kI.required]),content:new a.NI("",[a.kI.required]),categoryId:new a.NI("",[a.kI.required])}),this._destroyRef=(0,t.f3M)(t.ktI)}ngOnInit(){this.isLoading.set(!0),this.articleCategorySrv.getArticleCategory().pipe((0,u.h)(e=>this.sharedSrv.ifSuccess(e)),(0,d.U)(({data:{categorys:e}})=>e),(0,d.U)(e=>e.map(({categoryId:s,categoryName:o})=>({value:s,text:o}))),(0,m.x)(()=>this.isLoading.set(!1)),(0,p.sL)(this._destroyRef)).subscribe(e=>{e=[{text:"\u8acb\u9078\u64c7\u6587\u7ae0\u5206\u985e",value:"",disabled:!0},...e],this.categoryOptions.set(e)})}submit(){if(this.form.markAllAsTouched(),!this.form.valid)return;const e={articleTitle:this.form.get("articleTitle").value,previewContent:this.form.get("previewContent").value,content:this.form.get("content").value,categoryId:this.form.get("categoryId").value,userId:this.sharedSrv.getUserId(),prevFiles:this.prevFiles(),contentFiles:this.contentFiles()};this.createIsLoading.set(!0),this.articleSrv.createArticle(e).pipe((0,u.h)(s=>this.sharedSrv.ifSuccess(s)),(0,C.w)(({returnMessage:s})=>this.swalSrv.alert({icon:c.u.Success,text:s})),(0,m.x)(()=>this.createIsLoading.set(!1)),(0,p.sL)(this._destroyRef)).subscribe(()=>{this.router.navigate(["/setting/article"])})}previewUpload(e){this.prevFiles.update(s=>[...s,e])}contentUpload(e){this.contentFiles.update(s=>[...s,e])}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-article-create"]],standalone:!0,features:[t.jDz],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],[3,"formGroup","ngSubmit"],[1,"my-5"],["labelName","\u6587\u7ae0\u6a19\u984c","labelClass","text-lg my-2 text-center md:text-left","placeholder","\u8acb\u8f38\u5165\u6587\u7ae0\u6a19\u984c","formControlName","articleTitle",1,"w-full"],["labelName","\u6587\u7ae0\u5206\u985e","labelClass","text-lg my-2 text-center md:text-left","formControlName","categoryId",1,"w-full",3,"options"],["labelName","\u9810\u89bd\u5167\u5bb9","labelClass","text-lg my-2 text-center md:text-left","placeholder","\u8acb\u8f38\u5165\u9810\u89bd\u5167\u5bb9","formControlName","previewContent"],["labelName","\u6587\u7ae0\u5167\u5bb9","labelClass","text-lg my-2 text-center md:text-left","formControlName","content"],[1,"flex","justify-end","items-center"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(e,s){if(1&e&&(t.YNc(0,O,13,5,"ng-container",0),t.YNc(1,D,1,0,"ng-template",null,1,t.W1O)),2&e){const o=t.MAs(2);t.Q6J("ngIf",!s.isLoading())("ngIfElse",o)}},dependencies:[_.ez,_.O5,E.a,f.P,a.UX,a._Y,a.JJ,a.JL,a.sg,a.u,v.H,M.$]}),n})()}}]);