"use strict";(self.webpackChunkRonWeb=self.webpackChunkRonWeb||[]).push([[736],{4736:(K,m,t)=>{t.r(m),t.d(m,{ProjectExperienceCreateComponent:()=>L});var d=t(177),e=t(4438),r=t(9417),P=t(7587),x=t(19),j=t(6090),E=t(9079),u=t(5964),p=t(6354),h=t(8141),D=t(7468),v=t(980),M=t(5558),O=t(7343),C=t(9478),g=t(2953),A=t(4366),R=t(2539),f=t(7113),T=t(5264),I=t(7653),B=t(4444);function W(l,_){if(1&l){const i=e.RV6();e.qex(0),e.j41(1,"form",2),e.bIt("ngSubmit",function(){e.eBV(i);const s=e.XpG();return e.Njj(s.submit())}),e.j41(2,"div",3),e.nrm(3,"app-input",4),e.k0s(),e.j41(4,"div",3),e.nrm(5,"app-multiple-select",5),e.k0s(),e.j41(6,"div",3),e.nrm(7,"app-multiple-select",6),e.k0s(),e.j41(8,"div",3)(9,"app-editor",7),e.bIt("upload",function(s){e.eBV(i);const o=e.XpG();return e.Njj(o.contributionsUpload(s))}),e.k0s()(),e.j41(10,"div",3)(11,"app-editor",8),e.bIt("upload",function(s){e.eBV(i);const o=e.XpG();return e.Njj(o.descriptionUpload(s))}),e.k0s()(),e.j41(12,"div",9)(13,"button",10),e.EFF(14," \u65b0\u589e\u5c08\u6848\u7d93\u6b77 "),e.k0s()()(),e.bVm()}if(2&l){const i=e.XpG();e.R7$(),e.Y8G("formGroup",i.form),e.R7$(4),e.Y8G("options",i.projectRoleOptions()),e.R7$(2),e.Y8G("options",i.technologyToolOptions()),e.R7$(2),e.Y8G("adapter",i.contributionsUploadAdapter),e.R7$(2),e.Y8G("adapter",i.descriptionUploadAdapter),e.R7$(2),e.AVh("loading",i.createIsLoading()),e.Y8G("disabled",i.createIsLoading())}}function U(l,_){1&l&&e.nrm(0,"app-load-project-experience")}let L=(()=>{var l;class _{constructor(){this.apiSrv=(0,e.WQX)(O.G),this.userSrv=(0,e.WQX)(g.D),this.swalSrv=(0,e.WQX)(C.X),this.uploadAdapterSrv=(0,e.WQX)(T.c),this.projectExperienceSrv=(0,e.WQX)(I.M),this.codeSrv=(0,e.WQX)(R._),this.router=(0,e.WQX)(A.Ix),this.location=(0,e.WQX)(d.aZ),this.isLoading=(0,e.vPA)(!1),this.createIsLoading=(0,e.vPA)(!1),this.projectRoleOptions=(0,e.vPA)([]),this.technologyToolOptions=(0,e.vPA)([]),this.descriptionFiles=(0,e.vPA)([]),this.contributionsFiles=(0,e.vPA)([]),this.descriptionUploadAdapter=this.uploadAdapterSrv.createProjectExperienceAdapter(),this.contributionsUploadAdapter=this.uploadAdapterSrv.createProjectExperienceAdapter(),this.form=new r.gE({name:new r.MJ("",[r.k0.required]),projectRoles:new r.MJ([],[r.k0.required]),technologyTools:new r.MJ([],[r.k0.required]),description:new r.MJ("",[r.k0.required]),contributions:new r.MJ("",[r.k0.required])}),this._destroyRef=(0,e.WQX)(e.abz)}ngOnInit(){this.isLoading.set(!0);const n=this.codeSrv.getAdminCode(f.R.ProjectRole).pipe((0,u.p)(o=>this.apiSrv.ifSuccess(o)),(0,p.T)(({data:{codes:o}})=>o),(0,p.T)(o=>o.map(c=>({value:c.codeId,text:c.codeName}))),(0,h.M)(o=>this.projectRoleOptions.set(o))),s=this.codeSrv.getAdminCode(f.R.TechnologyTool).pipe((0,u.p)(o=>this.apiSrv.ifSuccess(o)),(0,p.T)(({data:{codes:o}})=>o),(0,p.T)(o=>o.map(c=>({value:c.codeId,text:c.codeName}))),(0,h.M)(o=>this.technologyToolOptions.set(o)));(0,D.p)([n,s]).pipe((0,v.j)(()=>this.isLoading.set(!1)),(0,E.pQ)(this._destroyRef)).subscribe()}submit(){var n,s;if(this.form.markAllAsTouched(),this.form.invalid)return;const o=null!==(n=this.form.controls.projectRoles.value)&&void 0!==n?n:[],c=this.projectRoleOptions().filter(a=>o.includes(a.value)).map(a=>({text:a.text,value:a.value})),b=null!==(s=this.form.controls.technologyTools.value)&&void 0!==s?s:[],y=this.technologyToolOptions().filter(a=>b.includes(a.value)).map(a=>({text:a.text,value:a.value})),S={name:this.form.controls.name.value,description:this.form.controls.description.value,contributions:this.form.controls.contributions.value,projectRoles:c,technologyTools:y,descriptionFiles:this.descriptionFiles(),contributionsFiles:this.contributionsFiles(),userId:this.userSrv.getUserId()};this.createIsLoading.set(!0),this.projectExperienceSrv.createProjectExperience(S).pipe((0,u.p)(a=>this.apiSrv.ifSuccess(a)),(0,M.n)(({returnMessage:a})=>this.swalSrv.alert({icon:C.J.Success,text:a})),(0,v.j)(()=>this.createIsLoading.set(!1)),(0,E.pQ)(this._destroyRef)).subscribe(()=>this.location.back())}descriptionUpload(n){this.descriptionFiles.update(s=>[...s,n])}contributionsUpload(n){this.contributionsFiles.update(s=>[...s,n])}}return(l=_).\u0275fac=function(n){return new(n||l)},l.\u0275cmp=e.VBU({type:l,selectors:[["app-project-experience-create"]],standalone:!0,features:[e.aNF],decls:3,vars:2,consts:[["loading",""],[4,"ngIf","ngIfElse"],[3,"ngSubmit","formGroup"],[1,"my-5"],["labelName","\u5c08\u6848\u540d\u7a31","labelClass","text-lg my-2 text-center md:text-left","placeholder","\u8acb\u8f38\u5165\u5c08\u6848\u540d\u7a31","formControlName","name",1,"w-full"],["labelName","\u5c08\u6848\u89d2\u8272","placeholder","\u8acb\u9078\u64c7\u5c08\u6848\u89d2\u8272","labelClass","text-lg my-2 text-center md:text-left","formControlName","projectRoles",1,"w-full",3,"options"],["labelName","\u5c08\u6848\u6280\u8853","placeholder","\u8acb\u9078\u64c7\u5c08\u6848\u6280\u8853","labelClass","text-lg my-2 text-center md:text-left","formControlName","technologyTools",1,"w-full",3,"options"],["labelName","\u5c08\u6848\u8ca2\u737b","labelClass","text-lg my-2 text-center md:text-left","formControlName","contributions",3,"upload","adapter"],["labelName","\u5c08\u6848\u63cf\u8ff0","labelClass","text-lg my-2 text-center md:text-left","placeholder","\u8acb\u8f38\u5165\u5c08\u6848\u63cf\u8ff0","formControlName","description",3,"upload","adapter"],[1,"flex","justify-end","items-center"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(n,s){if(1&n&&e.DNE(0,W,15,8,"ng-container",1)(1,U,1,0,"ng-template",null,0,e.C5r),2&n){const o=e.sdS(2);e.Y8G("ngIf",!s.isLoading())("ngIfElse",o)}},dependencies:[d.MD,d.bT,x.S,P.x,r.X1,r.qT,r.BC,r.cb,r.j4,r.JD,j.A,B.$]}),_})()}}]);