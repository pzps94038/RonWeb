"use strict";(self.webpackChunkRonWeb=self.webpackChunkRonWeb||[]).push([[330],{5330:(P,u,r)=>{r.r(u),r.d(u,{ArticleEditComponent:()=>M});var t=r(3020),h=r(4755),s=r(5030),p=r(7724),f=r(9128),v=r(6481),c=r(508),o=r(9300),l=r(4004),_=r(3900),g=r(8505),C=r(6274),A=r(8884),I=r(3500),m=r(9096),d=r(9148);let M=(()=>{class i{constructor(){this.sharedSrv=(0,t.f3M)(I.F),this.swalSrv=(0,t.f3M)(m.J),this.articleCategorySrv=(0,t.f3M)(C.h),this.articleSrv=(0,t.f3M)(A.n),this.route=(0,t.f3M)(d.gz),this.router=(0,t.f3M)(d.F0),this._destroyRef=(0,t.f3M)(t.ktI),this.categoryOptions=(0,t.tdS)([]),this.form=new s.cw({articleId:new s.NI("",[s.kI.required]),articleTitle:new s.NI("",[s.kI.required]),previewContent:new s.NI("",[s.kI.required]),content:new s.NI("",[s.kI.required]),categoryId:new s.NI("",[s.kI.required])})}ngOnInit(){this.route.paramMap.pipe((0,o.h)(e=>!!e.get("id")),(0,l.U)(e=>e.get("id")),(0,_.w)(e=>this.articleSrv.getArticleById(e)),(0,o.h)(e=>this.sharedSrv.ifSuccess(e)),(0,l.U)(({data:e})=>e),(0,g.b)(({articleId:e,articleTitle:a,previewContent:n,content:O,categoryId:D})=>{this.form.get("articleId")?.setValue(e),this.form.get("articleTitle")?.setValue(a),this.form.get("content")?.setValue(O),this.form.get("categoryId")?.setValue(D),this.form.get("previewContent")?.setValue(n)}),(0,_.w)(()=>this.articleCategorySrv.getArticleCategory()),(0,o.h)(e=>this.sharedSrv.ifSuccess(e,!0)),(0,l.U)(({data:e})=>e),(0,l.U)(e=>e.map(({categoryId:a,categoryName:n})=>({value:a,text:n}))),(0,c.sL)(this._destroyRef)).subscribe(e=>{e=[{text:"\u8acb\u9078\u64c7\u6587\u7ae0\u5206\u985e",value:"",disabled:!0},...e],this.categoryOptions.set(e)})}submit(){if(this.form.markAllAsTouched(),!this.form.valid)return;const e={articleId:this.form.get("articleId").value,articleTitle:this.form.get("articleTitle").value,previewContent:this.form.get("previewContent").value,content:this.form.get("content").value,categoryId:this.form.get("categoryId").value,userId:this.sharedSrv.getUserId()};this.articleSrv.updateArticle(e).pipe((0,o.h)(a=>this.sharedSrv.ifSuccess(a,!0)),(0,_.w)(({returnMessage:a})=>this.swalSrv.alert({icon:m.u.Success,text:a})),(0,c.sL)(this._destroyRef)).subscribe(()=>{this.router.navigate(["/setting/article"])})}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-article-edit"]],standalone:!0,features:[t.jDz],decls:12,vars:2,consts:[[3,"formGroup","ngSubmit"],[1,"my-5"],["labelName","\u6587\u7ae0\u6a19\u984c","labelClass","text-lg my-2 text-center md:text-left","placeholder","\u8acb\u8f38\u5165\u6587\u7ae0\u6a19\u984c","formControlName","articleTitle",1,"w-full"],["labelName","\u6587\u7ae0\u5206\u985e","labelClass","text-lg my-2 text-center md:text-left","formControlName","categoryId",1,"w-full",3,"options"],["labelName","\u9810\u89bd\u5167\u5bb9","labelClass","text-lg my-2 text-center md:text-left","placeholder","\u8acb\u8f38\u5165\u9810\u89bd\u5167\u5bb9","formControlName","previewContent"],["labelName","\u6587\u7ae0\u5167\u5bb9","labelClass","text-lg my-2 text-center md:text-left","formControlName","content"],[1,"flex","justify-end","items-center"],["type","submit",1,"btn","btn-primary"]],template:function(e,a){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return a.submit()}),t.TgZ(1,"div",1),t._UZ(2,"app-input",2),t.qZA(),t.TgZ(3,"div",1),t._UZ(4,"app-select",3),t.qZA(),t.TgZ(5,"div",1),t._UZ(6,"app-editor",4),t.qZA(),t.TgZ(7,"div",1),t._UZ(8,"app-editor",5),t.qZA(),t.TgZ(9,"div",6)(10,"button",7),t._uU(11,"\u4fee\u6539\u6587\u7ae0"),t.qZA()()()),2&e&&(t.Q6J("formGroup",a.form),t.xp6(4),t.Q6J("options",a.categoryOptions()))},dependencies:[h.ez,f.a,p.P,s.UX,s._Y,s.JJ,s.JL,s.sg,s.u,v.H]}),i})()}}]);