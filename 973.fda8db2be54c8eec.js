"use strict";(self.webpackChunkRonWeb=self.webpackChunkRonWeb||[]).push([[973],{4973:(B,p,n)=>{n.r(p),n.d(p,{SearchComponent:()=>A});var t=n(3020),i=n(4755),g=n(9148),d=n(508),l=n(9841),h=n(9300),m=n(262),E=n(8746),u=n(3757),f=n(3500),M=n(3772),C=n(3556),y=n(3093),O=n(279),v=n(6586);const P=function(r,_){return{categoryId:r,categoryName:_}};function D(r,_){if(1&r){const e=t.EpF();t.TgZ(0,"app-article-card",6),t.NdJ("category",function(a){t.CHM(e);const s=t.oxw(3);return t.KtG(s.navigateCategory(a))})("showMore",function(){const s=t.CHM(e).$implicit,c=t.oxw(3);return t.KtG(c.showMore(s.articleId))}),t.qZA()}if(2&r){const e=_.$implicit;t.Q6J("title",e.articleTitle)("date",e.createDate)("category",t.WLB(4,P,e.categoryId,e.categoryName))("previewContent",e.previewContent)}}function x(r,_){if(1&r&&(t.ynx(0),t.TgZ(1,"div",4)(2,"h3"),t._uU(3),t.qZA()(),t.YNc(4,D,1,7,"app-article-card",5),t.BQk()),2&r){const e=t.oxw(2);t.xp6(3),t.hij("\u4ee5\u4e0b\u662f",e.keyword(),"\u7684\u641c\u5c0b\u7d50\u679c\uff1a"),t.xp6(1),t.Q6J("ngForOf",e.articles())}}function T(r,_){if(1&r&&(t.ynx(0),t.YNc(1,x,5,2,"ng-container",0),t.BQk()),2&r){const e=t.oxw(),o=t.MAs(2);t.xp6(1),t.Q6J("ngIf",!e.isLoading())("ngIfElse",o)}}function I(r,_){1&r&&t._UZ(0,"app-loading-keyword")(1,"app-loading-card")(2,"app-loading-card")(3,"app-loading-card")}function S(r,_){if(1&r){const e=t.EpF();t.TgZ(0,"div",7)(1,"app-error",8),t.NdJ("refresh",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.searchKeyword(a.keyword(),a.page()))}),t.qZA()()}}let A=(()=>{class r{constructor(){this.route=(0,t.f3M)(g.gz),this.router=(0,t.f3M)(g.F0),this.searchSrv=(0,t.f3M)(u.o),this.sharedSrv=(0,t.f3M)(f.F),this.keyword=(0,t.tdS)(""),this.total=(0,t.tdS)(0),this.articles=(0,t.tdS)([]),this.isLoading=(0,t.tdS)(!1),this.isError=(0,t.tdS)(!1),this.page=(0,t.tdS)(1),this._destroyRef=(0,t.f3M)(t.ktI)}ngOnInit(){(0,l.a)([this.route.paramMap,this.route.queryParamMap]).pipe((0,h.h)(([e])=>!!e.get("keyword")||(this.router.navigate(["blog"]),!1)),(0,d.sL)(this._destroyRef)).subscribe(([e,o])=>{const a=e.get("keyword");this.keyword.set(a.trim());const s=o.get("page"),c=s?parseInt(s):1;this.page.set(isNaN(c)?1:c),this.searchKeyword(this.keyword(),this.page())})}searchKeyword(e,o){this.isError.set(!1),this.isLoading.set(!0),this.searchSrv.keyword(e,o).pipe((0,m.K)(a=>{throw this.isError.set(!0),a}),(0,E.x)(()=>this.isLoading.set(!1)),(0,d.sL)(this._destroyRef)).subscribe(a=>{if(this.sharedSrv.ifSuccess(a)){const{data:{total:s,articles:c}}=a;this.total.set(s),this.articles.set(c)}else this.isError.set(!0)})}showMore(e){this.router.navigateByUrl(`/blog/article/${e}`)}navigateCategory({categoryId:e}){this.router.navigateByUrl(`/blog/category/${e}`)}paginationChange(e){this.router.navigate(["blog","search",this.keyword()],{queryParams:{page:e}})}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-search"]],standalone:!0,features:[t.jDz],decls:6,vars:4,consts:[[4,"ngIf","ngIfElse"],["loading",""],["error",""],[3,"total","currentPage","change"],[1,"p-5","bg-base-100","border","border-base-content/10","text-base-content","rounded-md","mx-0","md:mx-5","mb-5"],[3,"title","date","category","previewContent","showMore",4,"ngFor","ngForOf"],[3,"title","date","category","previewContent","showMore"],[1,"bg-neutral","text-neutral-content","rounded-md","mx-0","md:mx-5","p-5","mb-5"],[3,"refresh"]],template:function(e,o){if(1&e&&(t.YNc(0,T,2,2,"ng-container",0),t.YNc(1,I,4,0,"ng-template",null,1,t.W1O),t.YNc(3,S,2,0,"ng-template",null,2,t.W1O),t.TgZ(5,"app-pagination",3),t.NdJ("change",function(s){return o.paginationChange(s)}),t.qZA()),2&e){const a=t.MAs(4);t.Q6J("ngIf",!o.isError())("ngIfElse",a),t.xp6(5),t.Q6J("total",o.total())("currentPage",o.page())}},dependencies:[i.ez,i.sg,i.O5,C.Q,y.y,M.q,O.o,v.g]}),r})()}}]);