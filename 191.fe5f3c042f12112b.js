"use strict";(self.webpackChunkRonWeb=self.webpackChunkRonWeb||[]).push([[191],{6191:(W,d,r)=>{r.r(d),r.d(d,{ProjectExperienceCreateComponent:()=>B});var _=r(4755),e=r(9416),n=r(9401),v=r(5028),x=r(6355),g=r(9379),m=r(5855),u=r(9300),c=r(4004),h=r(8505),M=r(4128),E=r(8746),P=r(3900),O=r(7929),C=r(9096),D=r(4052),I=r(1415),T=r(6737),f=r(9415),A=r(231),j=r(2266),R=r(5555);function U(l,p){if(1&l){const t=e.EpF();e.ynx(0),e.TgZ(1,"form",2),e.NdJ("ngSubmit",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.submit())}),e.TgZ(2,"div",3),e._UZ(3,"app-input",4),e.qZA(),e.TgZ(4,"div",3),e._UZ(5,"app-multiple-select",5),e.qZA(),e.TgZ(6,"div",3),e._UZ(7,"app-multiple-select",6),e.qZA(),e.TgZ(8,"div",3)(9,"app-editor",7),e.NdJ("upload",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.descriptionUpload(o))}),e.qZA()(),e.TgZ(10,"div",3)(11,"app-editor",8),e.NdJ("upload",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.contributionsUpload(o))}),e.qZA()(),e.TgZ(12,"div",9)(13,"button",10),e._uU(14," \u65b0\u589e\u5c08\u6848\u7d93\u6b77 "),e.qZA()()(),e.BQk()}if(2&l){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(4),e.Q6J("options",t.projectRoleOptions()),e.xp6(2),e.Q6J("options",t.technologyToolOptions()),e.xp6(2),e.Q6J("adapter",t.uploadAdapter),e.xp6(2),e.Q6J("adapter",t.uploadAdapter),e.xp6(2),e.ekj("loading",t.createIsLoading()),e.Q6J("disabled",t.createIsLoading())}}function L(l,p){1&l&&e._UZ(0,"app-load-project-experience")}let B=(()=>{class l{constructor(){this.apiSrv=(0,e.f3M)(O.s),this.userSrv=(0,e.f3M)(D.K),this.swalSrv=(0,e.f3M)(C.J),this.uploadAdapterSrv=(0,e.f3M)(A.z),this.projectExperienceSrv=(0,e.f3M)(j.n),this.codeSrv=(0,e.f3M)(T.c),this.router=(0,e.f3M)(I.F0),this.location=(0,e.f3M)(_.Ye),this.isLoading=(0,e.tdS)(!1),this.createIsLoading=(0,e.tdS)(!1),this.projectRoleOptions=(0,e.tdS)([]),this.technologyToolOptions=(0,e.tdS)([]),this.descriptionFiles=(0,e.tdS)([]),this.contributionsFiles=(0,e.tdS)([]),this.uploadAdapter=this.uploadAdapterSrv.createProjectExperienceAdapter(),this.form=new n.cw({name:new n.NI("",[n.kI.required]),projectRoles:new n.NI([],[n.kI.required]),technologyTools:new n.NI([],[n.kI.required]),description:new n.NI("",[n.kI.required]),contributions:new n.NI("",[n.kI.required])}),this._destroyRef=(0,e.f3M)(e.ktI)}ngOnInit(){this.isLoading.set(!0);const t=this.codeSrv.getAdminCode(f.h.ProjectRole).pipe((0,u.h)(o=>this.apiSrv.ifSuccess(o)),(0,c.U)(({data:{codes:o}})=>o),(0,c.U)(o=>o.map(a=>({value:a.codeId,text:a.codeName}))),(0,h.b)(o=>this.projectRoleOptions.set(o))),s=this.codeSrv.getAdminCode(f.h.TechnologyTool).pipe((0,u.h)(o=>this.apiSrv.ifSuccess(o)),(0,c.U)(({data:{codes:o}})=>o),(0,c.U)(o=>o.map(a=>({value:a.codeId,text:a.codeName}))),(0,h.b)(o=>this.technologyToolOptions.set(o)));(0,M.D)([t,s]).pipe((0,E.x)(()=>this.isLoading.set(!1)),(0,m.sL)(this._destroyRef)).subscribe()}submit(){var t,s;if(this.form.markAllAsTouched(),this.form.invalid)return;const o=null!==(t=this.form.controls.projectRoles.value)&&void 0!==t?t:[],a=this.projectRoleOptions().filter(i=>o.includes(i.value)).map(i=>({text:i.text,value:i.value})),S=null!==(s=this.form.controls.technologyTools.value)&&void 0!==s?s:[],y=this.technologyToolOptions().filter(i=>S.includes(i.value)).map(i=>({text:i.text,value:i.value})),K={name:this.form.controls.name.value,description:this.form.controls.description.value,contributions:this.form.controls.contributions.value,projectRoles:a,technologyTools:y,descriptionFiles:this.descriptionFiles(),contributionsFiles:this.contributionsFiles(),userId:this.userSrv.getUserId()};this.createIsLoading.set(!0),this.projectExperienceSrv.createProjectExperience(K).pipe((0,u.h)(i=>this.apiSrv.ifSuccess(i)),(0,P.w)(({returnMessage:i})=>this.swalSrv.alert({icon:C.u.Success,text:i})),(0,E.x)(()=>this.createIsLoading.set(!1)),(0,m.sL)(this._destroyRef)).subscribe(()=>this.location.back())}descriptionUpload(t){this.descriptionFiles.update(s=>[...s,t])}contributionsUpload(t){this.contributionsFiles.update(s=>[...s,t])}}return l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-project-experience-create"]],standalone:!0,features:[e.jDz],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],[3,"formGroup","ngSubmit"],[1,"my-5"],["labelName","\u5c08\u6848\u540d\u7a31","labelClass","text-lg my-2 text-center md:text-left","placeholder","\u8acb\u8f38\u5165\u5c08\u6848\u540d\u7a31","formControlName","name",1,"w-full"],["labelName","\u5c08\u6848\u89d2\u8272","placeholder","\u8acb\u9078\u64c7\u5c08\u6848\u89d2\u8272","labelClass","text-lg my-2 text-center md:text-left","formControlName","projectRoles",1,"w-full",3,"options"],["labelName","\u5c08\u6848\u6280\u8853","placeholder","\u8acb\u9078\u64c7\u5c08\u6848\u6280\u8853","labelClass","text-lg my-2 text-center md:text-left","formControlName","technologyTools",1,"w-full",3,"options"],["labelName","\u5c08\u6848\u63cf\u8ff0","labelClass","text-lg my-2 text-center md:text-left","placeholder","\u8acb\u8f38\u5165\u5c08\u6848\u63cf\u8ff0","formControlName","description",3,"adapter","upload"],["labelName","\u5c08\u6848\u7d93\u6b77","labelClass","text-lg my-2 text-center md:text-left","formControlName","contributions",3,"adapter","upload"],[1,"flex","justify-end","items-center"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(t,s){if(1&t&&(e.YNc(0,U,15,8,"ng-container",0),e.YNc(1,L,1,0,"ng-template",null,1,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",!s.isLoading())("ngIfElse",o)}},dependencies:[_.ez,_.O5,x.a,v.P,n.UX,n._Y,n.JJ,n.JL,n.sg,n.u,g.M,R.B]}),l})()}}]);