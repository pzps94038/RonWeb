"use strict";(self.webpackChunkRonWeb=self.webpackChunkRonWeb||[]).push([[260],{4975:(B,f,t)=>{t.r(f),t.d(f,{SearchComponent:()=>W});var e=t(4438),E=t(177),C=t(4366),v=t(9079),T=t(4572),S=t(5964),l=t(9437),y=t(980),i=t(9584),c=t(4014),d=t(8403),p=t(8255),h=t(6147),M=t(7343),g=t(1659),u=t(2656);const m=(n,_)=>({categoryId:n,categoryName:_});function P(n,_){if(1&n){const a=e.RV6();e.j41(0,"app-article-card",6),e.bIt("category",function(o){e.eBV(a);const s=e.XpG(3);return e.Njj(s.navigateCategory(o))})("label",function(o){e.eBV(a);const s=e.XpG(3);return e.Njj(s.navigateLabel(o))})("showMore",function(){const o=e.eBV(a).$implicit,s=e.XpG(3);return e.Njj(s.showMore(o.articleId))}),e.k0s()}if(2&n){const a=_.$implicit,r=e.XpG(3);e.Y8G("articleId",a.articleId)("title",a.articleTitle)("date",a.createDate)("category",e.l_i(8,m,a.categoryId,a.categoryName))("labels",a.labels)("previewContent",a.previewContent)("highlightKeyword",!0)("keyword",r.keyword())}}function D(n,_){if(1&n&&(e.qex(0),e.j41(1,"div",4)(2,"h3"),e.EFF(3),e.k0s()(),e.DNE(4,P,1,11,"app-article-card",5),e.bVm()),2&n){const a=e.XpG(2);e.R7$(3),e.SpI("\u4ee5\u4e0b\u662f",a.keyword(),"\u7684\u641c\u5c0b\u7d50\u679c\uff1a"),e.R7$(),e.Y8G("ngForOf",a.articles())}}function O(n,_){if(1&n&&(e.qex(0),e.DNE(1,D,5,2,"ng-container",2),e.bVm()),2&n){const a=e.XpG(),r=e.sdS(2);e.R7$(),e.Y8G("ngIf",!a.isLoading())("ngIfElse",r)}}function I(n,_){1&n&&e.nrm(0,"app-loading-keyword")(1,"app-loading-card")(2,"app-loading-card")(3,"app-loading-card")}function b(n,_){if(1&n){const a=e.RV6();e.j41(0,"div",7)(1,"app-error",8),e.bIt("refresh",function(){e.eBV(a);const o=e.XpG();return e.Njj(o.searchKeyword(o.keyword(),o.page()))}),e.k0s()()}}let W=(()=>{var n;class _{constructor(){this.route=(0,e.WQX)(C.nX),this.router=(0,e.WQX)(C.Ix),this.articleSrv=(0,e.WQX)(g.q),this.apiSrv=(0,e.WQX)(M.G),this.codeBlockSrv=(0,e.WQX)(u.G),this.keyword=(0,e.vPA)(""),this.total=(0,e.vPA)(0),this.articles=(0,e.vPA)([]),this.isLoading=(0,e.vPA)(!1),this.isError=(0,e.vPA)(!1),this.page=(0,e.vPA)(1),this._destroyRef=(0,e.WQX)(e.abz)}ngOnInit(){(0,T.z)([this.route.paramMap,this.route.queryParamMap]).pipe((0,S.p)(([r])=>!!r.get("keyword")||(this.router.navigate(["blog"]),!1)),(0,v.pQ)(this._destroyRef)).subscribe(([r,o])=>{const s=r.get("keyword");this.keyword.set(s.trim());const A=o.get("page"),R=A?parseInt(A):1;this.page.set(isNaN(R)?1:R),this.searchKeyword(this.keyword(),this.page())})}searchKeyword(r,o){this.isError.set(!1),this.isLoading.set(!0),this.articleSrv.getArticle(o,r).pipe((0,l.W)(s=>{throw this.isError.set(!0),s}),(0,y.j)(()=>this.isLoading.set(!1)),(0,v.pQ)(this._destroyRef)).subscribe(s=>{if(this.apiSrv.ifSuccess(s,!1)){const{data:{total:A,articles:R}}=s;this.total.set(A),this.articles.set(R),this.codeBlockSrv.highlightAllBlock()}else this.isError.set(!0)})}showMore(r){this.router.navigateByUrl("/blog/article/".concat(r))}navigateCategory({categoryId:r}){this.router.navigateByUrl("/blog/category/".concat(r))}navigateLabel({labelId:r}){this.router.navigateByUrl("/blog/label/".concat(r))}paginationChange(r){this.router.navigate(["blog","search",this.keyword()],{queryParams:{page:r}})}}return(n=_).\u0275fac=function(r){return new(r||n)},n.\u0275cmp=e.VBU({type:n,selectors:[["app-search"]],standalone:!0,features:[e.aNF],decls:6,vars:4,consts:[["loading",""],["error",""],[4,"ngIf","ngIfElse"],[3,"change","total","currentPage"],[1,"p-5","bg-base-100","border","border-base-content/10","text-base-content","rounded-md","mx-0","md:mx-5","mb-5"],[3,"articleId","title","date","category","labels","previewContent","highlightKeyword","keyword","label","showMore",4,"ngFor","ngForOf"],[3,"category","label","showMore","articleId","title","date","labels","previewContent","highlightKeyword","keyword"],[1,"bg-neutral","text-neutral-content","rounded-md","mx-0","md:mx-5","p-5","mb-5"],[3,"refresh"]],template:function(r,o){if(1&r){const s=e.RV6();e.DNE(0,O,2,2,"ng-container",2)(1,I,4,0,"ng-template",null,0,e.C5r)(3,b,2,0,"ng-template",null,1,e.C5r),e.j41(5,"app-pagination",3),e.bIt("change",function(R){return e.eBV(s),e.Njj(o.paginationChange(R))}),e.k0s()}if(2&r){const s=e.sdS(4);e.Y8G("ngIf",!o.isError())("ngIfElse",s),e.R7$(5),e.Y8G("total",o.total())("currentPage",o.page())}},dependencies:[E.MD,E.Sq,E.bT,c.e,d.O,i.A,p.G,h.z]}),_})()},3994:(B,f,t)=>{t.d(f,{N:()=>S});var e=t(4438),E=t(9819),C=t(7673),v=t(8141),T=t(9568);let S=(()=>{var l;class y{constructor(){this.transferState=(0,e.WQX)(e.pJN),this.deviceSrv=(0,e.WQX)(E.g)}transfer(c,d,p=!0){const h=(0,e.zw6)(c);if(this.transferState.hasKey(h)&&p){const M=this.transferState.get(h,void 0);return(0,C.of)(M)}return d().pipe((0,v.M)(g=>{this.deviceSrv.isServer&&this.transferState.set(h,g)}),(0,T.t)())}}return(l=y).\u0275fac=function(c){return new(c||l)},l.\u0275prov=e.jDH({token:l,factory:l.\u0275fac,providedIn:"root"}),y})()},9568:(B,f,t)=>{t.d(f,{t:()=>y});var e=t(2771),E=t(8750),C=t(1413),v=t(7707),T=t(9974);function l(i,c,...d){if(!0===c)return void i();if(!1===c)return;const p=new v.Ms({next:()=>{p.unsubscribe(),i()}});return(0,E.Tg)(c(...d)).subscribe(p)}function y(i,c,d){let p,h=!1;return i&&"object"==typeof i?({bufferSize:p=1/0,windowTime:c=1/0,refCount:h=!1,scheduler:d}=i):p=null!=i?i:1/0,function S(i={}){const{connector:c=(()=>new C.B),resetOnError:d=!0,resetOnComplete:p=!0,resetOnRefCountZero:h=!0}=i;return M=>{let g,u,m,P=0,D=!1,O=!1;const I=()=>{null==u||u.unsubscribe(),u=void 0},b=()=>{I(),g=m=void 0,D=O=!1},W=()=>{const n=g;b(),null==n||n.unsubscribe()};return(0,T.N)((n,_)=>{P++,!O&&!D&&I();const a=m=null!=m?m:c();_.add(()=>{P--,0===P&&!O&&!D&&(u=l(W,h))}),a.subscribe(_),!g&&P>0&&(g=new v.Ms({next:r=>a.next(r),error:r=>{O=!0,I(),u=l(b,d,r),a.error(r)},complete:()=>{D=!0,I(),u=l(b,p),a.complete()}}),(0,E.Tg)(n).subscribe(g))})(M)}}({connector:()=>new e.m(p,c,d),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:h})}}}]);